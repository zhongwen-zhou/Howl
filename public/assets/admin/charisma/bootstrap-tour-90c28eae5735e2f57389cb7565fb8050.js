// Generated by CoffeeScript 1.3.3
/* ============================================================
# bootstrap-tour.js v0.1
# http://pushly.github.com/bootstrap-tour/
# ==============================================================
# Copyright 2012 Push.ly
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
# 
#     http://www.apache.org/licenses/LICENSE-2.0
# 
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
*/
(function(){(function(e,t){var n,r;return r=t.document,n=function(){function n(t){var n=this;this._options=e.extend({afterSetState:function(e,t){},afterGetState:function(e,t){}},t),this._steps=[],this.setCurrentStep(),e(r).on("click",".popover .next",function(e){return e.preventDefault(),n.next()}),e(r).on("click",".popover .end",function(e){return e.preventDefault(),n.end()})}return n.prototype.setState=function(t,n){return e.cookie("tour_"+t,n,{expires:36500,path:"/"}),this._options.afterSetState(t,n)},n.prototype.getState=function(t){var n;return n=e.cookie("tour_"+t),this._options.afterGetState(t,n),n},n.prototype.addStep=function(e){return this._steps.push(e)},n.prototype.getStep=function(t){return e.extend({path:"",placement:"right",title:"",content:"",next:t+1,end:t===this._steps.length-1,animation:!0},this._steps[t])},n.prototype.start=function(e){e==null&&(e=!1);if(e||!this.ended())return this.showStep(this._current)},n.prototype.next=function(){return this.hideStep(this._current),this.showNextStep()},n.prototype.end=function(){return this.hideStep(this._current),this.setState("end","yes")},n.prototype.ended=function(){return!!this.getState("end")},n.prototype.restart=function(){return this.setState("current_step",null),this.setState("end",null),this.setCurrentStep(0),this.start()},n.prototype.hideStep=function(t){var n;return n=this.getStep(t),n.onHide!=null&&n.onHide(this),e(n.element).popover("hide")},n.prototype.showStep=function(t){var n,i,s=this;i=this.getStep(t);if(i.element==null){this.end;return}this.setCurrentStep(t);if(i.path!==""&&r.location.pathname!==i.path&&r.location.pathname.replace(/^.*[\\\/]/,"")!==i.path){r.location.href=i.path;return}if(e(i.element).is(":hidden")){this.showNextStep();return}return n=i.endOnClick||i.element,e(n).one("click",function(){return s.endCurrentStep()}),i.onShow!=null&&i.onShow(this),this._showPopover(i,t)},n.prototype.setCurrentStep=function(e){return e!=null?(this._current=e,this.setState("current_step",e)):(this._current=this.getState("current_step"),this._current===null||this._current==="null"?this._current=0:this._current=parseInt(this._current))},n.prototype.endCurrentStep=function(){var e;return this.hideStep(this._current),e=this.getStep(this._current),this.setCurrentStep(e.next)},n.prototype.showNextStep=function(){var e;return e=this.getStep(this._current),this.showStep(e.next)},n.prototype._showPopover=function(t,n){var r,i;return r=""+t.content+"<br /><p>",t.end?r+="<a href='#' class='end'>End</a>":r+="<a href='#"+t.next+"' class='next'>Next &raquo;</a>          <a href='#' class='pull-right end'>End tour</a></p>",e(t.element).popover({placement:t.placement,trigger:"manual",title:t.title,content:r,animation:t.animation}).popover("show"),i=e(t.element).data("popover").tip(),this._reposition(i),this._scrollIntoView(i)},n.prototype._reposition=function(t){var n,i,s;return s=t.offset(),n=e(r).outerHeight()-s.top-e(t).outerHeight(),n<0&&(s.top=s.top+n),i=e(r).outerWidth()-s.left-e(t).outerWidth(),i<0&&(s.left=s.left+i),s.top<0&&(s.top=0),s.left<0&&(s.left=0),t.offset(s)},n.prototype._scrollIntoView=function(n){var r;r=n.get(0).getBoundingClientRect();if(!(r.top>0&&r.bottom<e(t).height()&&r.left>0&&r.right<e(t).width()))return n.get(0).scrollIntoView(!0)},n}(),t.Tour=n})(jQuery,window)}).call(this);