<%= simple_form_for [:circle, @group, @activity, @account], :validate => true do |f| %>
  <%= f.input :sum, label: "金额" %>
  <%= f.input :io_type, label: "收支类型" %>
  <% unless @activity.present? %>
    <%= f.input :visable_status, label: "可见性", :as => :select, :include_blank => "请选择可见性……", collection: Activity::VISABLE_STATUS %>
    <%= f.input :paid_user_id, label: "付款人", :as => :select, collection: @group.users %>

    <div class="field">
        <ul id="genre_tab" class="nav nav-tabs">
          <li class="active"><a href="#category_type" val="Category" data-toggle="tab">类别帐务</a></li>
          <li><a href="#budget_type" val="Budget" data-toggle="tab">预算帐务</a></li>
          <li><a href="#activity_type" val="Activity" data-toggle="tab">活动帐务</a></li>
        </ul>
        <div class="tab-content">
          <div class="tab-pane active" id="category_type">
            <%= select_tag('account[genre_id]', option_groups_from_collection_for_select(Category.top_categories, :children, :name, :id, :name, 3)) %>
          </div>
          <div class="tab-pane" id="budget_type">
            <%= select_tag('account[genre_id]', options_from_collection_for_select(@budgets, :id, :name)) %>
          </div>   
          <div class="tab-pane" id="activity_type">
            <%= select_tag('account[genre_id]', options_from_collection_for_select(@activities, :id, :subject)) %>
          </div>             
        </div>
        <%= f.hidden_field(:genre_type, :value => 'Category') %>
    </div>   

  <% else %>
    <%= f.input :paid_user_id, label: "付款人", :as => :select, collection: @activity.users %>
  <% end %>
  <%= f.input :remark, :as => :text, label: "备注", :input_html => {:rows => 5, :cols =>25} %>
  <%= f.button :submit, :value => "记起" %>
<% end %>

<script type="text/javascript">
  $(document).ready(function(){
    $('#genre_type').tab('show');
    $('a[data-toggle="tab"]').on('shown', function (e) {
      $('#account_genre_type').attr('value',$(e.target).attr('val'))
    });
  })
</script>